<div class="gestion-container">
  <div class="header">
    <h1>Gestion des Approvisionnements</h1>
    <button class="btn btn-primary" (click)="nouveauApprovisionnement()">
      + Nouvel approvisionnement
    </button>
  </div>

  <!-- Filtres et recherche -->
  <div class="filters-section">
    <h2 class="section-title">Filtres et recherche</h2>
    
    <form [formGroup]="filterForm" class="filters-form">
      <div class="filters-row">
        <div class="filter-group search-group">
          <input 
            type="text" 
            formControlName="recherche"
            class="form-control search-input"
            placeholder="Rechercher..."
          />
          <button class="btn-search" type="button">
            üîç
          </button>
        </div>

        <div class="filter-group">
          <select formControlName="fournisseur" class="form-control">
            <option value="">Tous les fournisseurs</option>
            <option *ngFor="let fournisseur of fournisseurs" [value]="fournisseur.id">
              {{ fournisseur.nom }}
            </option>
          </select>
        </div>

        <div class="filter-group">
          <select formControlName="article" class="form-control">
            <option value="">Tous les articles</option>
            <option *ngFor="let article of articles" [value]="article.id">
              {{ article.nom }}
            </option>
          </select>
        </div>
      </div>

      <div class="filters-row">
        <div class="filter-group">
          <label>Du</label>
          <input 
            type="date" 
            formControlName="dateDebut"
            class="form-control"
          />
        </div>

        <div class="filter-group">
          <label>Au</label>
          <input 
            type="date" 
            formControlName="dateFin"
            class="form-control"
          />
        </div>

        <div class="filter-actions">
          <button 
            type="button" 
            class="btn btn-primary btn-filter"
            (click)="appliquerFiltres()"
          >
            üîç Filtrer
          </button>
          <button 
            type="button" 
            class="btn btn-secondary btn-reset"
            (click)="reinitialiserFiltres()"
          >
            üîÑ R√©initialiser
          </button>
        </div>
      </div>
    </form>
  </div>

  <!-- Tableau des approvisionnements -->
  <div class="table-section">
    <div class="table-wrapper">
      <table class="approvisionnements-table">
        <thead>
          <tr>
            <th>R√©f√©rence</th>
            <th>Date</th>
            <th>Fournisseur</th>
            <th>Articles</th>
            <th>Montant total</th>
            <th>Statut</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngIf="approvisionnementsFiltres.length === 0">
            <td colspan="7" class="empty-state">
              Aucun approvisionnement trouv√©
            </td>
          </tr>
          <tr *ngFor="let appro of approvisionnementsFiltres">
            <td class="ref-cell">{{ appro.reference }}</td>
            <td>{{ appro.date | date:'dd/MM/yyyy' }}</td>
            <td>{{ appro.fournisseur }}</td>
            <td>
              <div class="articles-badges">
                <span 
                 
                  class="badge badge-article"
                >
               {{ appro.articles.length }}
               articles
                </span>
               
              </div>
            </td>
            <td class="montant-cell">{{ appro.montantTotal | number:'1.0-0' }} FCFA</td>
            <td>
              <span 
                class="badge badge-statut"
                [ngClass]="{
                  'badge-recu': appro.statut === 'Re√ßu',
                  'badge-attente': appro.statut === 'En attente'
                }"
              >
                {{ appro.statut }}
              </span>
            </td>
            <td>
              <div class="actions-cell">
                <button 
                  class="btn-icon btn-view" 
                  (click)="voirDetails(appro.id)"
                  title="Voir"
                >
                  üëÅÔ∏è
                </button>
                <button 
                  class="btn-icon btn-edit" 
                  (click)="modifier(appro.id)"
                  title="Modifier"
                >
                  ‚úèÔ∏è
                </button>
                <button 
                  class="btn-icon btn-delete" 
                  (click)="supprimer(appro.id)"
                  title="Supprimer"
                >
                  üóëÔ∏è
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Pagination -->
    <div class="pagination" *ngIf="totalPages > 1">
      <button 
        class="btn-page" 
        (click)="changerPage(currentPage - 1)"
        [disabled]="currentPage === 1"
      >
        Pr√©c√©dent
      </button>
      
      <button 
        *ngFor="let page of pages" 
        class="btn-page"
        [class.active]="page === currentPage"
        (click)="changerPage(page)"
      >
        {{ page }}
      </button>
      
      <button 
        class="btn-page" 
        (click)="changerPage(currentPage + 1)"
        [disabled]="currentPage === totalPages"
      >
        Suivant
      </button>
    </div>
  </div>

  <!-- Statistiques -->
  <div class="stats-section">
    <div class="stat-card">
      <h3>Total des approvisionnements</h3>
      <p class="stat-value">{{ statistiques.totalMontant | number:'1.0-0' }} FCFA</p>
      <span class="stat-period">P√©riode: {{ statistiques.periode }}</span>
    </div>

    <div class="stat-card">
      <h3>Nombre d'approvisionnements</h3>
      <p class="stat-value">{{ statistiques.nombreTotal }}</p>
      <span class="stat-period">P√©riode: {{ statistiques.periode }}</span>
    </div>

    <div class="stat-card stat-highlight">
      <h3>Fournisseur principal</h3>
      <p class="stat-value stat-fournisseur">{{ statistiques.fournisseurPrincipal }}</p>
      <span class="stat-period">{{ statistiques.montantFournisseurPrincipal | number:'1.0-0' }} FCFA ({{ statistiques.pourcentageFournisseurPrincipal }}%)</span>
    </div>
  </div>
</div>